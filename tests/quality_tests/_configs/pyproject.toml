
# ###################################################################
# pyright options:

[tool.pyright]
include = ["."]
ignore = ["**/typings"]
exclude = [".*", "__*", "**/typings"]

typeCheckingMode = "basic"
stubPath = "typings"
typeshedPath = "typings"
pythonPlatform = "Linux"

reportMissingModuleSource = "none"
reportUnnecessaryTypeIgnoreComment = "error"

# ###################################################################
# mypy global options:
[tool.mypy]
platform = "linux"
mypy_path = "typings"
custom_typeshed_dir = "typings" # allow mypy to use micropython-stdlib
files = "*.py"
exclude = [
    "typings[\\/].*", # TOML basic string 
]

follow_imports = "silent"
follow_imports_for_stubs = true
no_site_packages = true
check_untyped_defs = true
disable_error_code = ["no-redef", "assignment", "var-annotated"]

# snippets may re-use the same variable names
allow_redefinition = true

# other optional settings
warn_unused_ignores = true  # allows to verify the absense of methods/classes in stubs 
# warn_unused_configs = true
# show_error_context = true

# ###################################################################
# ruff options:
[tool.ruff]
line-length = 140
target-version = "py39"

[tool.ruff.lint]
extend-select = [
    "PYI", # flake8-pyi - stub file specific checks
]
extend-ignore = [
    "F401", # unused import
    "F403", # import *
    "F405", # may be undefined, or defined from star imports

    "F811", # redefenition
    "F821", # undefined name (can occur in stubs)
    "F841", # Local variable `data` is assigned to but never used
    "E402", # module level import not at top of file - common in test snippets
    "E722", # Bare except
    "E741", # Ambiguous variable name
    "PYI021", # Docstrings should not be included in stubs (but we want them for MicroPython)
    "PYI024",  # do not use collections.namedtuple
    "PYI044", # `from __future__ import annotations` - used in generated stubs
    "PYI048", # Function body must contain exactly one statement - docstrings count
    "PYI011", # Only simple default values allowed for typed arguments - we want actual defaults
    "PYI014", # Only simple default values allowed for arguments - we want actual defaults
    "PYI029", # __str__ and __repr__ are useful in MicroPython stubs
]
# ###################################################################
